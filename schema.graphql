type Factory @entity {
  id: ID!
  address: String!

  owner: Account!

  createdAtTimestamp: BigInt!

  collections: [Collection!]! @derivedFrom(field: "factory")
  implementations: [Implementation!]! @derivedFrom(field: "factory")
}

type Implementation @entity {
  id: ID!
  name: String!
  address: String!

  factory: Factory!

  createdAtTimestamp: BigInt!

  collections: [Collection!]! @derivedFrom(field: "implementation")
}

type Collection @entity {
  id: ID!
  name: String!
  symbol: String!
  address: String!

  factory: Factory!
  implementation: Implementation!
  engine: Engine!
  creator: Account!
  owner: Account!

  createdAtTimestamp: BigInt!

  nfts: [NFT!]! @derivedFrom(field: "collection")
}

type Engine @entity {
  id: ID!
  address: String!
  name: String!

  createdAtTimestamp: BigInt!

  collections: [Collection!]! @derivedFrom(field: "engine")
}

type NFT @entity {
  id: ID!
  tokenId: BigInt!
  totalSupply: BigInt!

  collection: Collection!

  createdAtTimestamp: BigInt!

  owners: [NFTOwner!]! @derivedFrom(field: "nft")
  mints: [NFTMint!]! @derivedFrom(field: "nft")
}

type NFTOwner @entity {
  id: ID!
  nft: NFT!
  owner: Account!
  balance: BigInt!

  createdAtTimestamp: BigInt!
}

type NFTMint @entity {
  id: ID!
  nft: NFT!

  mintedBy: Account!
  mintedTo: Account!
  mintedByEngine: Engine!
  amount: BigInt!

  createdAtTimestamp: BigInt!
}

type Account @entity {
  id: ID!
  address: String!

  createdCollections: [Collection!]! @derivedFrom(field: "creator")
  ownedCollections: [Collection!]! @derivedFrom(field: "owner")
  ownedNfts: [NFTOwner!]! @derivedFrom(field: "owner")
  mintedNfts: [NFTMint!]! @derivedFrom(field: "mintedBy")
  receivedNfts: [NFTMint!]! @derivedFrom(field: "mintedTo")
}
